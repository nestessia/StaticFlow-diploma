@startuml
[*] --> Инициализация

state Инициализация {
    [*] --> ЗагрузкаКонфигурации
    ЗагрузкаКонфигурации --> НастройкаПутей
    НастройкаПутей --> ЗагрузкаТемы
    ЗагрузкаТемы --> ЗагрузкаШаблонов
    ЗагрузкаШаблонов --> ИнициализацияКэша
    ИнициализацияКэша --> [*]
}

Инициализация --> Ожидание

state Ожидание {
    [*] --> ОжиданиеКоманды
    ОжиданиеКоманды --> РедактированиеКонтента : открыть админку
    ОжиданиеКоманды --> ПроцессСборки : команда сборки
    ОжиданиеКоманды --> Публикация : команда публикации
}

state РедактированиеКонтента {
    [*] --> ОткрытиеСтраницы
    ОткрытиеСтраницы --> РедактированиеСтраницы
    РедактированиеСтраницы --> Предпросмотр : сохранить
    Предпросмотр --> РедактированиеСтраницы : продолжить редактирование
    Предпросмотр --> [*] : закрыть редактор
}

state ПроцессСборки {
    [*] --> ЗагрузкаСтраниц
    
    state ЗагрузкаСтраниц {
        [*] --> ОпределениеПарсера
        ОпределениеПарсера --> ПарсингКонтента : парсер найден
        ОпределениеПарсера --> ОшибкаПарсера : парсер не найден
        ПарсингКонтента --> [*]
        ОшибкаПарсера --> [*] : парсер добавлен
        ОшибкаПарсера --> Ожидание : отмена
    }
    
    ЗагрузкаСтраниц --> ОбработкаПлагинами
    
    state ОбработкаПлагинами {
        [*] --> ОбработкаСайта
        ОбработкаСайта --> ПроверкаКэшаПлагинов
        ПроверкаКэшаПлагинов --> ОбработкаСтраниц : кэш не найден
        ПроверкаКэшаПлагинов --> [*] : кэш найден
        ОбработкаСтраниц --> [*]
    }
    
    state ГенерацияСтраниц {
        [*] --> ПроверкаКэша
        ПроверкаКэша --> РендерингШаблона : кэш не найден
        РендерингШаблона --> ОбработкаПлагинамиСтраницы
        ОбработкаПлагинамиСтраницы --> СохранениеВКэш
        СохранениеВКэш --> [*]
        ПроверкаКэша --> [*] : кэш найден
    }
    
    ОбработкаПлагинами --> ГенерацияСтраниц
    ГенерацияСтраниц --> КопированиеСтатики
    КопированиеСтатики --> [*]
}

state Публикация {
    [*] --> НастройкаДеплоя
    НастройкаДеплоя --> ОтправкаНаGitHub
    ОтправкаНаGitHub --> ПроверкаСтатуса
    ПроверкаСтатуса --> [*]
}

state Очистка {
    [*] --> ОчисткаВыходнойПапки
    ОчисткаВыходнойПапки --> ОчисткаКэша
    ОчисткаКэша --> ОчисткаПлагинов
    ОчисткаПлагинов --> [*]
}

state Ошибка {
    [*] --> ОбработкаОшибки
    ОбработкаОшибки --> Ожидание : ошибка исправлена
    ОбработкаОшибки --> [*] : критическая ошибка
}

ПроцессСборки --> Ожидание : успешно
ПроцессСборки --> Ошибка : ошибка
Публикация --> Ожидание : успешно
Публикация --> Ошибка : ошибка
РедактированиеКонтента --> Ожидание

Ожидание --> Очистка : команда очистки
Очистка --> Ожидание

Ожидание --> [*] : завершение работы

@enduml